app.preferences.rulerUnits = Units.PIXELS;displayDialogs =DialogModes.NO;//open(File(openDialog()));var docRef = app.activeDocument;var originalLayer = docRef.activeLayer;docRef.resizeImage(1242);var imageLayer = originalLayer.duplicate();//docRef.resizeCanvas(1242, 1760, AnchorPosition.TOPCENTER);function explodeArray(item) { 	var i=0;	var Count=0; 	var tempString=new String(item); 	tempArray=new Array(1); 	do{ 		i=tempString.indexOf(":");		if(i>0)			tempString=tempString.substr(i+1,tempString.length-i-1);		i=tempString.indexOf(">");		if(i>0)	{			tempArray[Count]=tempString.substr(0,i); 			tempString=tempString.substr(i+1,tempString.length-i-1);			Count ++;		}		i=tempString.indexOf("<");		if(i>0) {			tempArray[Count]=tempString.substr(0,i); 			tempString=tempString.substr(i, tempString.length-i);			Count ++;		}	}while (tempString.indexOf("</x:xmpmeta>")>0);	tempArray[Count]=tempString; 	return tempArray; } var exifData = docRef.xmpMetadata.rawData.toString();//~ alert(exifData);//将EXIF信息分成单个的相关信息explodeArray(exifData); var dateArray1="";var dateArray2="";var model="";			//相机型号var focalLength=""; 		//焦距var exposureTime=""; 		//快门var fNumber="";			//光圈var dateTimeOriginal="";	//拍摄时间//相机厂商for(n = 0; n < tempArray.length; n ++) { 	stringTemp=tempArray[n];	if(stringTemp.indexOf("Make")!=-1){ 		var make = tempArray[n+1]; 		break;	} }//相机型号for(n = 0; n < tempArray.length; n ++) { 	stringTemp=tempArray[n];	if(stringTemp.indexOf("Model")!=-1){ 		var model = tempArray[n+1]; 		break;	} }//对于有的相机型号不包括制造商部分//camera = make+model; //对于有的相机型号包括制造商部分var camera = make+" "+model; //使用焦距for(n = 0; n < tempArray.length; n ++) { 	stringTemp=tempArray[n];	if(tempArray[n]=="FocalLength"){ 		focalLength = tempArray[n+1];		break;	} }//检查焦距dateArray1 = focalLength.split("/");i = dateArray1[0];j = dateArray1[1];focalLength=parseInt(i/j);//快门速度for(n = 0; n < tempArray.length; n ++) { 	stringTemp=tempArray[n];	if(stringTemp.indexOf("ExposureTime")!=-1)	{ 		exposureTime = tempArray[n+1]; 		break;	} }//检查快门速度dateArray1 = exposureTime.split("/");j = dateArray1[0];i = dateArray1[1];if(j/i>=1)	exposureTime=parseInt(j/i)+"."+(j-parseInt(j/i)*i);else{	i=parseInt(i/j);	j=1;	exposureTime=j+"/"+i;}//光圈大小for(n = 0; n < tempArray.length; n ++) { 	stringTemp=tempArray[n];	if(stringTemp.indexOf("FNumber")!=-1){ 		fNumber = tempArray[n+1];		break;	} }//计算光圈大小dateArray1 = fNumber.split("/");i = dateArray1[0];j = dateArray1[1];if(j>1)	fNumber=i/j;else	fNumber=i;//拍摄日期、时间for(n = 0; n < tempArray.length; n ++) { 	stringTemp=tempArray[n];	if(stringTemp.indexOf("DateTimeOriginal")!=-1){ 		dateTimeOriginal = tempArray[n+1]; 		break;	} }//改变日期格式dateArray1 = dateTimeOriginal.split("T"); phoDate = dateArray1[0];phoTime = dateArray1[1];dateArray2 = phoDate.split("-"); //~ monthsArray =["1", //~ 	"2", //~ 	"3", //~ 	"4", //~ 	"5",//~ 	"6", //~ 	"7", //~ 	"8", //~ 	"9", //~ 	"10", //~ 	"11", //~ 	"12"]; monthsArray = ["JAN",    "FEB",    "MAR",    "APR",    "MAY",    "JUN",    "JUL",    "AUG",    "SEP",    "OCT",    "NOV",    "DEC"];phoDate = monthsArray[dateArray2[1]-1]+"."+dateArray2[2]+'.'+dateArray2[0];//~ dateArray2 = phoTime.split("+");//~ phoTime = dateArray2[0];//~ var contentLayer = docRef.artLayers.add();//~ contentLayer.kind = LayerKind.TEXT;//~ var contentItem = contentLayer.textItemcontentColor = new SolidColor;nameColor = new SolidColor;cardColor = new SolidColor;// 文字和日期所选用的颜色 #404040contentColor.rgb.red = contentColor.rgb.blue = contentColor.rgb.green = 64;//  名字by部分所选用的颜色 #b6b6b6nameColor.rgb.red = nameColor.rgb.blue = nameColor.rgb.green = 182;// 卡片底色 #f9f9f9cardColor.rgb.red = cardColor.rgb.blue = cardColor.rgb.green = 249;app.backgroundColor = cardColor;// 设置字体//var enFont = app.fonts.getByName("AGaramondPro-Regular");//var cnFont = app.fonts.getByName("儷宋Pro");var dateLayer = docRef.artLayers.add();dateLayer.kind = LayerKind.TEXT;var dateItem = dateLayer.textItem;dateItem.contents = phoDate;dateItem.font = "AGaramondPro-Regular";dateItem.color = contentColor;dateItem.justification = Justification.LEFT;dateItem.size = 46.53;dateItem.position = [55, docRef.height+66+20];dateItem.tracking = 0;docRef.resizeCanvas(1242, 1760, AnchorPosition.TOPCENTER);//=================// 创建正文文字图层//=================var contentLayer = docRef.artLayers.add();contentLayer.kind = LayerKind.TEXT;var contentItem = contentLayer.textItem;//contentItem.contents = "在奔赴使命的路上"+String.fromCharCode(13)+"忙碌屬於每一個人"+String.fromCharCode(13)+"香港，中環";//contentItem.contents = "在奔赴使命的路上";//~ contentItem.contents = "I played through the sweat and hurt"+String.fromCharCode(13)+"Not because challenge called me"+String.fromCharCode(13)+"But because YOU called me."//~ contentItem.contents = camera;contentItem.contents = camera+String.fromCharCode(13)+focalLength+"mm,"+exposureTime+"Sec,F/"+fNumber+", EV ";contentItem.font = "AGaramondPro-Regular";contentItem.color = contentColor;contentItem.justification = Justification.LEFT;contentItem.size = 39.29;contentItem.tracking = 0;contentItem.spaceAfter = new UnitValue(11, 'pt');var tranX = contentLayer.bounds[0]-55;var tranY = 1760-55-contentLayer.bounds[3];contentLayer.translate(-tranX, -tranY);//=================// 创建署名文字图层//=================var useridLayer = docRef.artLayers.add();useridLayer.kind = LayerKind.TEXT;var useridItem = useridLayer.textItem;useridItem.contents = "by: davidac";useridItem.font = "AGaramondPro-Regular";useridItem.color = contentColor;useridItem.justification = Justification.RIGHT;useridItem.size = 38.58;useridItem.tracking = 0;var tranM = 1242-55-useridLayer.bounds[2];var tranN = 1760-55-useridLayer.bounds[3];useridLayer.translate(-tranM, -tranN);